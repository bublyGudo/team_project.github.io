<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Healthy Stores/Markets &amp; Overweight</title>

<script src="site_libs/header-attrs-2.28/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="team.html">Team</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Results
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="store_density_and_household_income.html">Store Density vs Household Income</a>
    </li>
    <li>
      <a href="store_overweight_regression.html">Store Density vs Overweight Percentage</a>
    </li>
    <li>
      <a href="pendemic_impact_on_stores.html">Pendemic Impact On Stores</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Walkability
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://bublygudo.shinyapps.io/walkable/">ShinyApp: Walkability</a>
    </li>
    <li>
      <a href="walkability_summary.html">Walkability Summary</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Data Sources
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Data-Source.html">Data Sources</a>
    </li>
    <li>
      <a href="data_cleaning.html">Data Cleaning</a>
    </li>
  </ul>
</li>
<li>
  <a href="Report.html">Project Report</a>
</li>
<li>
  <a href="mailto:fw2394@cumc.columbia.edu, cm3341@cumc.columbia.edu, tc3326@cumc.columbia.edu, scs2267@cumc.columbia.edu, zw2975@cumc.columbia.edu">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/bublyGudo/team_project.github.io">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Healthy Stores/Markets &amp;
Overweight</h1>

</div>


<p><img src="markets.jpg" style="width: 100%;"></p>
<pre class="r"><code># Import datasets for regression analysis
retail_food_stores = read.csv(&quot;./data/Retail_Food_Stores_clean.csv&quot;)

overwt = read.csv(&quot;./data/Overweight by boroughs.csv&quot;)

# average the percentage for each borough
overwt_mean = overwt |&gt;
  mutate(perc_overwt = word(Percent, 1)) |&gt;
  mutate(perc_overwt = as.numeric(perc_overwt)) |&gt;
  group_by(Geography) |&gt;
  summarize(perc = mean(perc_overwt, na.rm =TRUE))|&gt;
  rename(county = Geography) 


# group numbers of stores by counties
num_stores = retail_food_stores |&gt;
  group_by(borough, zip_code)|&gt;
  count() |&gt;
  rename (store_num = n,
          county = borough)

# join datasets
regression_data = left_join(overwt_mean, num_stores, by=&quot;county&quot;)

# load &quot;stores&quot; dataset and cleaning up:
stores = read.csv(&quot;./data/Recognized_Shop_Healthy_Stores_20241116.csv&quot;) |&gt; 
  janitor::clean_names() |&gt; 
  mutate(borough = case_when(
    borough == &quot;New York&quot; ~ &quot;Manhattan&quot;,
    TRUE ~ borough
  )) |&gt; 
  rename(year = year_awarded, healthy_store_market = store_name) |&gt; 
  distinct(latitude, longitude,.keep_all = TRUE) |&gt; 
  select (healthy_store_market, borough, year)

# load &quot;farmer markets&quot; data and cleaning up:
farmer_market = read.csv(&quot;./data/farmers_market_data.csv&quot;) |&gt; 
  janitor::clean_names() |&gt; 
  distinct(latitude, longitude,.keep_all = TRUE) |&gt; 
  select(farmers_market, borough, year) |&gt; 
  rename(healthy_store_market = farmers_market) 

# bind &quot;stores&quot; and &quot;farmer_market&quot;:
stores_farmer_market = rbind(stores, farmer_market)

# clean overweight data:
overweight = overwt |&gt; 
  separate (Percent, into = c(&quot;percent&quot;, &quot;low_confidence&quot;, &quot;highconfidence&quot;))|&gt; 
  mutate(percent = as.numeric(percent)) |&gt; 
  janitor::clean_names() |&gt; 
  rename (borough = geography, year = time_period, overweight_percentage = percent) |&gt; 
  select(overweight_percentage, borough, year)

# calculate the number store/market in each borough in each year:
counts = stores_farmer_market |&gt; 
  drop_na() |&gt; 
  group_by(year, borough) |&gt; 
  summarise(count = n(), .groups = &quot;drop&quot;)

## join healthy store/market and overweight together
store_market_overweight = full_join (counts, overweight, by = join_by(year, borough)) |&gt; 
  mutate(year = as.factor(year))

# write csv file for later use
write.csv(store_market_overweight, &quot;./data/store_market_overweight.csv&quot;)</code></pre>
<p><br><br></p>
<div id="exploratory-data-analysis" class="section level2">
<h2>Exploratory Data Analysis</h2>
<div id="healthy-food-stores-and-farmers-markets-in-each-borough"
class="section level3">
<h3>Healthy Food Stores and Farmer’s Markets in Each Borough</h3>
<pre class="r"><code># The Number of Healthy Stores/Farmer Markets in Each Borough
  store_market_overweight |&gt;
    group_by(borough) |&gt; 
    summarise(sum = sum(count, na.rm = TRUE)) |&gt; 
    ggplot(aes(x = borough, y = sum, fill = borough)) +
  geom_bar(stat = &quot;identity&quot;) +
  labs(
    x = &quot;Borough&quot;,
    y = &quot;Number&quot;,
    title = &quot;The Number of Healthy Stores/Farmer Markets in Each Borough&quot;) +
  theme(legend.position = &quot;none&quot;)+
  theme(plot.title=element_text(size=22, face=&quot;bold&quot;)) +
theme(plot.title = element_text(hjust = 0.5))</code></pre>
<p><img src="store_overweight_regression_files/figure-html/EDA-1.png" width="960" /></p>
<p><em>1. Brooklyn has the highest number of healthy stores and farmer
markets, followed by the Bronx and Manhattan. Queens and Staten Island
have significantly fewer healthy stores and farmer markets.</em></p>
<p><em>2. The result is what we expected. Larger boroughs with higher
population densities like Brooklyn and the Bronx are expected to have
more establishments. Staten Island’s lower density explains its fewer
establishments.</em></p>
<p><em>3. Disparity in the availability of healthy food resources is
evident. Policy efforts should target underserved boroughs (e.g., Staten
Island and Queens) to improve access to healthy food options.</em></p>
<p><br></p>
</div>
<div id="overweight-percentage-changes-by-year-in-each-nyc-borough"
class="section level3">
<h3>Overweight Percentage Changes by Year in Each NYC Borough</h3>
<pre class="r"><code># Overweight Percentage Changes by Year in Each Borough
  store_market_overweight |&gt;
  filter(year !=2023) |&gt; 
  ggplot(aes(x = as.numeric(year), y = overweight_percentage, color = borough)) +
  geom_point() + 
  geom_smooth(method = &quot;loess&quot;, se = FALSE) +
  scale_x_continuous(
    breaks = unique(as.numeric(store_market_overweight$year)),  # Ensure all years are displayed
    labels = unique(store_market_overweight$year)  # Keep the labels as regular years
  ) +
  labs(
    x = &quot;Year&quot;,
    y = &quot;Overweight Percentage (%)&quot;,
    color = &quot;Borough&quot;,
    title = &quot;Overweight Percentage Changes by Year in Each Borough&quot;
  ) +
  theme(plot.title=element_text(size=24, face=&quot;bold&quot;)) +
  theme(plot.title = element_text(hjust = 0.5))</code></pre>
<p><img src="store_overweight_regression_files/figure-html/overweight-1.png" width="960" /></p>
<p><em>1. The Bronx and Staten Island have the highest overweight
percentages, peaking around 70%. Manhattan consistently shows the lowest
overweight percentages. Overweight percentages have generally declined
since 2017–2018.</em></p>
<p><em>2. The result is what we expected. Disparities align with
socioeconomic and geographic differences. Affluent areas like Manhattan
are more likely to support healthier lifestyles, while areas like the
Bronx face systemic challenges.</em></p>
<p><em>3. Declining overweight percentages may reflect the impact of
health initiatives. Borough-specific interventions are necessary to
address persistently high rates in the Bronx and Staten Island.</em></p>
<p><br></p>
</div>
<div
id="linear-regression-models---number-of-retail-food-stores-healthy-food-stores-vs.-percentage-overweight"
class="section level3">
<h3>Linear Regression Models - Number of Retail Food Stores/ Healthy
Food Stores vs. Percentage Overweight</h3>
<p><br></p>
<div id="retail-food-stores-linear-regression-model"
class="section level4">
<h4>Retail Food Stores (linear regression model)</h4>
<pre class="r"><code># scatterplot for linear regression
regression_data |&gt;
  na.omit() |&gt;
  ggplot(aes(x = store_num, y = perc))  +
  geom_point() +  
  geom_smooth(method = &quot;lm&quot;, se = FALSE) +  # Add a linear trend line
  labs(
    title = &quot;Overweight Percentage vs. Number of Stores by Zip Codes&quot;,
    x = &quot;Number of Stores (by zip codes)&quot;,
    y = &quot;Overweight Percentage (%)&quot;) +
  theme_minimal()+
  theme(plot.title=element_text(size=14, face=&quot;bold&quot;)) +
  theme(plot.title = element_text(hjust = 0.5))</code></pre>
<p><img src="store_overweight_regression_files/figure-html/scatterplot%20m1-1.png" width="960" /></p>
<p><em>The plot suggests a positive association between the number of
retail food stores and overweight percentage.</em></p>
<p><br></p>
<div id="model-summary" class="section level5">
<h5>Model Summary</h5>
<pre class="r"><code># Pearson&#39;s Linear Regression
m1 = lm(perc ~ store_num, data = regression_data)

summary(m1) |&gt; 
  broom::tidy()|&gt;
  mutate(term = ifelse(term == &quot;store_num&quot;, &quot;Slope (Number of Retail Food Stores)&quot;, term)) |&gt; 
  knitr::kable(caption = &quot;Association Between The Number of Retail Food Stores and Overweight Percentages&quot;)</code></pre>
<table>
<caption>Association Between The Number of Retail Food Stores and
Overweight Percentages</caption>
<colgroup>
<col width="48%" />
<col width="14%" />
<col width="12%" />
<col width="12%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">53.6472336</td>
<td align="right">0.7534963</td>
<td align="right">71.197737</td>
<td align="right">0.00e+00</td>
</tr>
<tr class="even">
<td align="left">Slope (Number of Retail Food Stores)</td>
<td align="right">0.0430127</td>
<td align="right">0.0097448</td>
<td align="right">4.413923</td>
<td align="right">1.72e-05</td>
</tr>
</tbody>
</table>
<p><em>1. The relationship between number of retail food store and
percentage of overweight is significant (p-value &lt; 0.05) and there
appears to be a weak positive association between them.</em></p>
<p><em>2. However, assumptions of linear regression should be checked
before making any conclusion of this model.</em></p>
<p><br></p>
</div>
</div>
<div id="healthy-food-stores-linear-regression-model"
class="section level4">
<h4>Healthy Food Stores (linear regression model)</h4>
<pre class="r"><code># Plot: Number of Healthy Stores/Farmer Markets and Overweight Percentages

store_market_overweight |&gt; 
  na.omit() |&gt; 
  ggplot(aes(x = overweight_percentage, y = count)) +
  geom_point() +
  geom_smooth(method = lm, se = FALSE) +
  labs(
    title = &quot;Association Between The Number of Healthy Stores/Farmer Markets and Overweight Percentages&quot;,
    x = &quot;Overweight Percentage (%)&quot;,
    y = &quot;Number of Healthy Stores/Farmer Markets&quot;
  ) +
  theme_minimal()+
  theme(plot.title=element_text(size=14, face=&quot;bold&quot;)) +
  theme(plot.title = element_text(hjust = 0.5))</code></pre>
<p><img src="store_overweight_regression_files/figure-html/linear-1.png" width="960" /></p>
<p><em>The plot suggests a negative association between the overweight
percentage and the number of healthy stores or farmer markets. Regions
with a higher overweight percentage tend to have fewer healthy stores or
farmer markets on average.</em></p>
<p><br></p>
<div id="model-summary-1" class="section level5">
<h5>Model Summary</h5>
<pre class="r"><code>model = lm(overweight_percentage ~ count, data = store_market_overweight)

summary(model) |&gt; 
  broom::tidy() |&gt;
    mutate(term = ifelse(term == &quot;count&quot;, &quot;Slope (Number of Healthy Food Stores)&quot;, term)) |&gt; 
  knitr::kable(caption = &quot;Association Between The Number of Healthy Stores/Farmer Markets and Overweight Percentages&quot;)</code></pre>
<table>
<caption>Association Between The Number of Healthy Stores/Farmer Markets
and Overweight Percentages</caption>
<colgroup>
<col width="47%" />
<col width="13%" />
<col width="12%" />
<col width="13%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">60.1167336</td>
<td align="right">2.3803062</td>
<td align="right">25.2558827</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">Slope (Number of Healthy Food Stores)</td>
<td align="right">-0.0499049</td>
<td align="right">0.0690072</td>
<td align="right">-0.7231828</td>
<td align="right">0.4753605</td>
</tr>
</tbody>
</table>
<p><em>1. While the coefficient for count (-0.05) suggests a slight
negative relationship between the number of healthy stores/farmer
markets and overweight percentages, the relationship is weak and not
statistically significant.</em></p>
<p><em>2. The large p-value (0.475) indicates that the variability in
the data may overshadow the effect of healthy store availability on
overweight prevalence.</em></p>
<p><em>3. Other factors may play a more significant role in explaining
the variation in overweight percentages.</em></p>
<p><br><br></p>
</div>
</div>
</div>
</div>
<div id="additional-data-analysis" class="section level2">
<h2>Additional Data Analysis</h2>
<p><br></p>
<div id="assumption-check" class="section level3">
<h3>Assumption Check</h3>
<p><br></p>
<div id="normality---retail-food-store-model" class="section level4">
<h4>Normality - Retail Food Store Model</h4>
<pre class="r"><code># Extract residuals
residuals = resid(m1)

# base R qqplot
qqnorm(residuals, main = &quot;QQ Plot of Residuals&quot;)
qqline(residuals, col = &quot;red&quot;, lwd = 2)</code></pre>
<p><img src="store_overweight_regression_files/figure-html/normality-1.png" width="672" /></p>
<pre class="r"><code># Create a data frame for plotting
residual_data = data.frame(residuals = residuals)

# Checking using histogram
ggplot(residual_data, aes(x = residuals)) +
  geom_histogram(binwidth = 1, fill = &quot;lightblue&quot;, color = &quot;black&quot;, alpha = 0.7) +  # Adjust binwidth as needed
  labs(
    title = &quot;Histogram of Residuals&quot;,
    x = &quot;Residuals&quot;,
    y = &quot;Frequency&quot; ) </code></pre>
<p><img src="store_overweight_regression_files/figure-html/normality-2.png" width="672" /></p>
<p><em>Normality is not met: Residuals appear not to align with the
reference line and doesn’t have a linear trend.</em></p>
<p><em>Histogram is showing residual values clustering at the 2 ends,
which also indicates a violation of normality.</em></p>
<p><br></p>
</div>
<div id="homoscedasticity-equal-variance---retail-food-store-model"
class="section level4">
<h4>Homoscedasticity (equal variance) - Retail Food Store Model</h4>
<pre class="r"><code># residual vs. fitted value
plot(fitted(m1), resid(m1),
     main = &quot;Residuals vs Fitted Values&quot;,
     xlab = &quot;Fitted Values&quot;,
     ylab = &quot;Residuals&quot;,
     pch = 20)  # Add points
abline(h = 0, col = &quot;red&quot;, lwd = 2)  # Add a reference line at zero</code></pre>
<p><img src="store_overweight_regression_files/figure-html/Homoscedasticity%20(equal%20variance)-1.png" width="672" /></p>
<pre class="r"><code># Perform the Breusch-Pagan test
bp_result = bptest(m1)

# Extract key components into a data frame
bp_table = data.frame(
  Metric = c(&quot;Breusch-Pagan Statistic&quot;, &quot;Degrees of Freedom&quot;, &quot;P-value&quot;),
  Value = c(
    round(bp_result$statistic, 3),
    as.character(bp_result$parameter),  # Degrees of freedom
    signif(bp_result$p.value, 3)))

# Create a table using knitr::kable
knitr::kable(
  bp_table,
  caption = &quot;Breusch-Pagan Test Results for Homoscedasticity&quot;,
  col.names = c(&quot;Metric&quot;, &quot;Value&quot;))</code></pre>
<table>
<caption>Breusch-Pagan Test Results for Homoscedasticity</caption>
<thead>
<tr class="header">
<th align="left">Metric</th>
<th align="left">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Breusch-Pagan Statistic</td>
<td align="left">2.775</td>
</tr>
<tr class="even">
<td align="left">Degrees of Freedom</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">P-value</td>
<td align="left">0.0957</td>
</tr>
</tbody>
</table>
<p><em>Homoscedasticity (equal variance) is met: p-value &gt; 0.05 for
the Breusch-Pagan test, which indicates we fail to reject the null
hypothesis that there is not heteroscedasticity (non-equal
variance).</em></p>
<p><br></p>
</div>
<div id="linearity---retail-food-store-model" class="section level4">
<h4>Linearity - Retail Food Store Model</h4>
<pre class="r"><code># Perform the RESET test
reset_result = resettest(m1)

# Extract key components into a data frame
reset_table = data.frame(
  Metric = c(&quot;RESET Statistic&quot;, &quot;Degrees of Freedom&quot;, &quot;P-value&quot;),
  Value = c(
    round(reset_result$statistic, 3),
    paste0(reset_result$parameter, collapse = &quot;, &quot;),
    signif(reset_result$p.value, 3)))

# Create a table using knitr::kable
knitr::kable(
  reset_table,
  caption = &quot;RESET Test Results for Linearity&quot;,
  col.names = c(&quot;Metric&quot;, &quot;Value&quot;))</code></pre>
<table>
<caption>RESET Test Results for Linearity</caption>
<thead>
<tr class="header">
<th align="left">Metric</th>
<th align="left">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">RESET Statistic</td>
<td align="left">1.398</td>
</tr>
<tr class="even">
<td align="left">Degrees of Freedom</td>
<td align="left">2, 184</td>
</tr>
<tr class="odd">
<td align="left">P-value</td>
<td align="left">0.25</td>
</tr>
</tbody>
</table>
<pre class="r"><code># p-value &gt; 0.05, linearity assumption is not met</code></pre>
<p><em>Linearity is not met: P-value &gt; 0.05 for RESET test.</em></p>
<p><br></p>
</div>
<div id="normality---healthy-food-store-model" class="section level4">
<h4>Normality - Healthy Food Store Model</h4>
<pre class="r"><code># Extract residuals
residuals = resid(model)

# base R qqplot
qqnorm(residuals, main = &quot;QQ Plot of Residuals&quot;)
qqline(residuals, col = &quot;red&quot;, lwd = 2)</code></pre>
<p><img src="store_overweight_regression_files/figure-html/residuals-1.png" width="960" /></p>
<p><em>The Normality assumption is likely met: the QQ plot shows
residuals scattered reasonably around the reference line.</em></p>
<p><br></p>
</div>
<div id="homoscedasticity-equal-variance---healthy-food-store-model"
class="section level4">
<h4>Homoscedasticity (equal variance) - Healthy Food Store Model</h4>
<pre class="r"><code># residual vs. fitted value
plot(fitted(model), resid(model),
     main = &quot;Residuals vs Fitted Values&quot;,
     xlab = &quot;Fitted Values&quot;,
     ylab = &quot;Residuals&quot;,
     pch = 20)  # Add points
abline(h = 0, col = &quot;red&quot;, lwd = 2)  # Add a reference line at zero</code></pre>
<p><img src="store_overweight_regression_files/figure-html/homoscedasticity%20(healthy%20food%20stores)-1.png" width="672" /></p>
<pre class="r"><code># Perform the Breusch-Pagan test
bp_result_1 = bptest(model)

# Extract key components into a data frame
bp_table = data.frame(
  Metric = c(&quot;Breusch-Pagan Statistic&quot;, &quot;Degrees of Freedom&quot;, &quot;P-value&quot;),
  Value = c(
    round(bp_result_1$statistic, 3),
    as.character(bp_result_1$parameter),  # Degrees of freedom
    signif(bp_result_1$p.value, 3)))

# Create a table using knitr::kable
knitr::kable(
  bp_table,
  caption = &quot;Breusch-Pagan Test Results for Homoscedasticity&quot;,
  col.names = c(&quot;Metric&quot;, &quot;Value&quot;))</code></pre>
<table>
<caption>Breusch-Pagan Test Results for Homoscedasticity</caption>
<thead>
<tr class="header">
<th align="left">Metric</th>
<th align="left">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Breusch-Pagan Statistic</td>
<td align="left">0.186</td>
</tr>
<tr class="even">
<td align="left">Degrees of Freedom</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">P-value</td>
<td align="left">0.666</td>
</tr>
</tbody>
</table>
<p><em>Homoscedasticity (equal variance) is met: p-value &gt; 0.05 for
the Breusch-Pagan test, which indicates we fail to reject the null
hypothesis that there is not heteroscedasticity (non-equal
variance).</em></p>
<p><br></p>
</div>
<div id="linearity---healthy-food-store-model" class="section level4">
<h4>Linearity - Healthy Food Store Model</h4>
<pre class="r"><code># Perform the RESET test
reset_result_1 = resettest(model)

# Extract key components into a data frame
reset_table = data.frame(
  Metric = c(&quot;RESET Statistic&quot;, &quot;Degrees of Freedom&quot;, &quot;P-value&quot;),
  Value = c(
    round(reset_result_1$statistic, 3),
    paste0(reset_result_1$parameter, collapse = &quot;, &quot;),
    signif(reset_result_1$p.value, 3)))

# Create a table using knitr::kable
knitr::kable(
  reset_table,
  caption = &quot;RESET Test Results for Linearity&quot;,
  col.names = c(&quot;Metric&quot;, &quot;Value&quot;))</code></pre>
<table>
<caption>RESET Test Results for Linearity</caption>
<thead>
<tr class="header">
<th align="left">Metric</th>
<th align="left">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">RESET Statistic</td>
<td align="left">0.083</td>
</tr>
<tr class="even">
<td align="left">Degrees of Freedom</td>
<td align="left">2, 27</td>
</tr>
<tr class="odd">
<td align="left">P-value</td>
<td align="left">0.92</td>
</tr>
</tbody>
</table>
<pre class="r"><code># p-value &gt; 0.05, linearity assumption is not met</code></pre>
<p><em>Linearity is not met: P-value &gt; 0.05 for RESET test.</em></p>
<p><br></p>
</div>
</div>
<div id="non-parametric-test---spearmans-rank-test"
class="section level3">
<h3>Non-parametric Test - Spearman’s Rank Test</h3>
<p><em>Since some of the assumptions for Pearson’s correlation (linear
regression method) are not met for both models (number of retail food
store/ healthy food store vs. percentage overweight), we need to use
non-parametric test, Spearman’s rank test, to test for any significance
in the models</em></p>
<p><br></p>
<div id="retail-food-stores" class="section level4">
<h4>Retail Food Stores</h4>
<pre class="r"><code># scatterplot for non-linear regression
regression_data |&gt;
  na.omit() |&gt;
  ggplot(aes(x = store_num, y = perc))  +
  geom_point() +  
  geom_smooth(method = &quot;loess&quot;, se = FALSE) +  # Add a linear trend line
  labs(
    title = &quot;Non-linear: Overweight Percentage vs. Number of Stores by Zip Codes&quot;,
    x = &quot;Number of Stores (by zip codes)&quot;,
    y = &quot;Overweight Percentage (%)&quot;) +
  theme_minimal()+
  theme(plot.title=element_text(size=14, face=&quot;bold&quot;)) +
  theme(plot.title = element_text(hjust = 0.5))</code></pre>
<p><img src="store_overweight_regression_files/figure-html/nonlinear%20scatterplot%20m1-1.png" width="960" /></p>
<pre class="r"><code>spearman_result = cor.test(regression_data$store_num, regression_data$perc, method = &quot;spearman&quot;)

# Extract key components
results = data.frame(
  Statistic = c(&quot;Spearman&#39;s rho&quot;, &quot;P-value&quot;),
  Value = c(round(spearman_result$estimate, 3), signif(spearman_result$p.value, 3)))

# Create a table
knitr::kable(
  results,
  caption = &quot;Spearman&#39;s Rank Correlation Test Results (Retail Food Stores)&quot;,
  col.names = c(&quot;Metric&quot;, &quot;Value&quot;))</code></pre>
<table>
<caption>Spearman’s Rank Correlation Test Results (Retail Food
Stores)</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">Metric</th>
<th align="right">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">rho</td>
<td align="left">Spearman’s rho</td>
<td align="right">0.1490</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">P-value</td>
<td align="right">0.0415</td>
</tr>
</tbody>
</table>
<p><em>Spearman’s Rho: 0.1490</em></p>
<p><em>This value indicates a weak positive correlation between the
number of general food stores and the percentage of overweight
individuals.</em> <em>While the relationship exists, it is not
particularly strong, suggesting other factors might also influence
overweight percentages.</em></p>
<p><em>P-value: 0.0415</em></p>
<p><em>The p-value is less than 0.05, indicating that the correlation is
statistically significant.</em> <em>This suggests that the observed
relationship is unlikely to have occurred by chance.</em></p>
<p><br></p>
</div>
<div id="healthy-food-stores" class="section level4">
<h4>Healthy Food Stores</h4>
<pre class="r"><code># Plot: Number of Healthy Stores/Farmer Markets and Overweight Percentages

store_market_overweight |&gt; 
  na.omit() |&gt; 
  ggplot(aes(x = overweight_percentage, y = count)) +
  geom_point() +
  geom_smooth(method = loess, se = FALSE) +
  labs(
    title = &quot;Non-linear Association Between The Number of Healthy Stores/Farmer Markets and Overweight Percentages&quot;,
    x = &quot;Overweight Percentage (%)&quot;,
    y = &quot;Number of Healthy Stores/Farmer Markets&quot;
  ) +
  theme_minimal()+
  theme(plot.title=element_text(size=14, face=&quot;bold&quot;)) +
  theme(plot.title = element_text(hjust = 0.5))</code></pre>
<p><img src="store_overweight_regression_files/figure-html/non%20linear-1.png" width="960" /></p>
<pre class="r"><code>spearman_result_1 = cor.test(store_market_overweight$count, store_market_overweight$overweight_percentage, method = &quot;spearman&quot;)

# Extract key components
results_1 = data.frame(
  Statistic = c(&quot;Spearman&#39;s rho&quot;, &quot;P-value&quot;),
  Value = c(round(spearman_result_1$estimate, 3), signif(spearman_result_1$p.value, 3)))

# Create a table
knitr::kable(
  results_1,
  caption = &quot;Spearman&#39;s Rank Correlation Test Results (Healthy Food Stores)&quot;,
  col.names = c(&quot;Metric&quot;, &quot;Value&quot;))</code></pre>
<table>
<caption>Spearman’s Rank Correlation Test Results (Healthy Food
Stores)</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">Metric</th>
<th align="right">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">rho</td>
<td align="left">Spearman’s rho</td>
<td align="right">-0.106</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">P-value</td>
<td align="right">0.569</td>
</tr>
</tbody>
</table>
<p><em>Spearman’s Rho: -0.106</em></p>
<p><em>This indicates a weak negative correlation between the number of
healthy food stores and the percentage of overweight individuals.</em>
<em>While the relationship is weak, the negative value suggests that as
the number of healthy food stores increases, the percentage of
overweight individuals slightly decreases.</em></p>
<p><em>P-value: 0.569</em></p>
<p><em>The p-value is greater than 0.05, indicating that the observed
correlation is not statistically significant.</em> <em>This means there
is insufficient evidence to conclude a meaningful relationship between
the number of healthy food stores and the percentage of overweight
individuals.</em></p>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
